<body><div><h2>Suffix Array | Set 1 (Introduction)</h2><div class="post-content" id="post-content">
					<p>We strongly recommend to read following post on suffix trees as a pre-requisite for this post.<span id="more-125731"></span></p>
<p><a href="http://www.geeksforgeeks.org/pattern-searching-set-8-suffix-tree-introduction/" target="_blank">Pattern Searching | Set 8 (Suffix Tree Introduction)</a></p>
<p><em><strong>A suffix array is a sorted array of all suffixes of a given string</strong></em>. The definition is similar to <a href="http://www.geeksforgeeks.org/pattern-searching-set-8-suffix-tree-introduction/" target="_blank">Suffix Tree which is compressed trie of all suffixes of the given text</a>. Any suffix tree based algorithm can be replaced with an algorithm that uses a suffix array enhanced with additional information and solves the same problem in the same time complexity (Source <a href="http://en.wikipedia.org/wiki/Suffix_array" target="_blank">Wiki</a>).<br>
A suffix array can be constructed from Suffix tree by doing a DFS traversal of the suffix tree.  In fact Suffix array and suffix tree both can be constructed from each other in linear time.<br>
Advantages of suffix arrays over suffix trees include improved space requirements, simpler linear time construction algorithms (e.g., compared to Ukkonen&#8217;s algorithm) and improved cache locality (Source: <a href="http://en.wikipedia.org/wiki/Suffix_array#Correspondence_to_suffix_trees" target="_blank">Wiki</a>)</p>
<p><em><strong>Example:</strong></em></p>
<pre>Let the given string be "banana".

0 banana                          5 a
1 anana     Sort the Suffixes     3 ana
2 nana      ----------------&gt;     1 anana
3 ana        alphabetically       0 banana
4 na                              4 na
5 a                               2 nana

So the suffix array for "banana" is {5, 3, 1, 0, 4, 2}</pre>
<p><em><strong>Naive method to build Suffix Array</strong></em><br>
A simple method to construct suffix array is to make an array of all suffixes and then sort the array.  Following is implementation of simple method.</p>
<pre class="brush: cpp; highlight: [20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47]; title: ; notranslate" title="">
// Naive algorithm for building suffix array of a given text
#include &lt;iostream&gt;
#include &lt;cstring&gt;
#include &lt;algorithm&gt;
using namespace std;

// Structure to store information of a suffix
struct suffix
{
    int index;
    char *suff;
};

// A comparison function used by sort() to compare two suffixes
int cmp(struct suffix a, struct suffix b)
{
    return strcmp(a.suff, b.suff) &lt; 0? 1 : 0;
}

// This is the main function that takes a string 'txt' of size n as an
// argument, builds and return the suffix array for the given string
int *buildSuffixArray(char *txt, int n)
{
    // A structure to store suffixes and their indexes
    struct suffix suffixes[n];

    // Store suffixes and their indexes in an array of structures.
    // The structure is needed to sort the suffixes alphabatically
    // and maintain their old indexes while sorting
    for (int i = 0; i &lt; n; i++)
    {
        suffixes[i].index = i;
        suffixes[i].suff = (txt+i);
    }

    // Sort the suffixes using the comparison function
    // defined above.
    sort(suffixes, suffixes+n, cmp);

    // Store indexes of all sorted suffixes in the suffix array
    int *suffixArr = new int[n];
    for (int i = 0; i &lt; n; i++)
        suffixArr[i] = suffixes[i].index;

    // Return the suffix array
    return  suffixArr;
}

// A utility function to print an array of given size
void printArr(int arr[], int n)
{
    for(int i = 0; i &lt; n; i++)
        cout &lt;&lt; arr[i] &lt;&lt; " ";
    cout &lt;&lt; endl;
}

// Driver program to test above functions
int main()
{
    char txt[] = "banana";
    int n = strlen(txt);
    int *suffixArr = buildSuffixArray(txt,  n);
    cout &lt;&lt; "Following is suffix array for " &lt;&lt; txt &lt;&lt; endl;
    printArr(suffixArr, n);
    return 0;
}
</pre>
<p>Output:</p>
<pre>Following is suffix array for banana
5 3 1 0 4 2</pre>
<p>The time complexity of above method to build suffix array is O(n<sup>2</sup>Logn) if we consider a O(nLogn) algorithm used for sorting.  The sorting step itself takes O(n<sup>2</sup>Logn) time as every comparison is a comparison of two strings and the comparison takes O(n) time.<br>
There are many efficient algorithms to build suffix array. We will soon be covering them as separate posts.</p>
<p><em><strong>Search a pattern using the built Suffix Array</strong></em><br>
To search a pattern in a text, we preprocess the text and build a suffix array of the text.  Since we have a sorted array of all suffixes, <a href="http://geeksquiz.com/binary-search/" target="_blank">Binary Search</a> can be used to search. Following is the search function. Note that the function doesn&#8217;t report all occurrences of pattern, it only report one of them. </p>
<pre class="brush: cpp; highlight: [4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36]; title: ; notranslate" title="">
// This code only contains search() and main. To make it a complete running
// above code or see http://ideone.com/1Io9eN

// A suffix array based search function to search a given pattern
// 'pat' in given text 'txt' using suffix array suffArr[]
void search(char *pat, char *txt, int *suffArr, int n)
{
    int m = strlen(pat);  // get length of pattern, needed for strncmp()

    // Do simple binary search for the pat in txt using the
    // built suffix array
    int l = 0, r = n-1;  // Initilize left and right indexes
    while (l &lt;= r)
    {
        // See if 'pat' is prefix of middle suffix in suffix array
        int mid = l + (r - l)/2;
        int res = strncmp(pat, txt+suffArr[mid], m);

        // If match found at the middle, print it and return
        if (res == 0)
        {
            cout &lt;&lt; "Pattern found at index " &lt;&lt; suffArr[mid];
            return;
        }

        // Move to left half if pattern is alphabtically less than
        // the mid suffix
        if (res &lt; 0) r = mid - 1;

        // Otherwise move to right half
        else l = mid + 1;
    }

    // We reach here if return statement in loop is not executed
    cout &lt;&lt; "Pattern not found";
}

// Driver program to test above function
int main()
{
    char txt[] = "banana";  // text
    char pat[] = "nan";   // pattern to be searched in text

    // Build suffix array
    int n = strlen(txt);
    int *suffArr = buildSuffixArray(txt, n);

    // search pat in txt using the built suffix array
    search(pat, txt, suffArr, n);

    return 0;
}
</pre>
<p>Output:
</p><pre>Pattern found at index 2</pre>
<p>The time complexity of the above search function is O(mLogn).  There are more efficient algorithms to search pattern once the suffix array is built. In fact there is a O(m) suffix array based algorithm to search a pattern.  We will soon be discussing efficient algorithm for search.</p>
<p><em><strong>Applications of Suffix Array</strong></em><br>
Suffix array is an extremely useful data structure, it can be used for a wide range of problems.  Following are some famous problems where Suffix array can be used.<br>
1) Pattern Searching<br>
2) <a href="http://en.wikipedia.org/wiki/Longest_repeated_substring_problem" target="_blank">Finding the longest repeated substring</a><br>
3) <a href="http://en.wikipedia.org/wiki/Longest_common_substring_problem" target="_blank">Finding the longest common substring</a><br>
4) <a href="http://en.wikipedia.org/wiki/Longest_palindromic_substring" target="_blank">Finding the longest palindrome in a string</a></p>
<p>See <a href="http://www.stanford.edu/class/cs97si/suffix-array.pdf" target="_blank">this</a> for more problems where Suffix arrays can be used.</p>
<p>This post is a simple introduction. There is a lot to cover in Suffix arrays. We have discussed <a href="http://www.geeksforgeeks.org/suffix-array-set-2-a-nlognlogn-algorithm/" target="_blank">a O(nLogn) algorithm for Suffix Array construction</a> <a href="http://www.geeksforgeeks.org/suffix-array-set-2-a-nlognlogn-algorithm/" target="_blank">here</a>. We will soon be discussing more efficient suffix array algorithms.</p>
<p><strong>References:</strong><br>
<a href="http://www.stanford.edu/class/cs97si/suffix-array.pdf" target="_blank">http://www.stanford.edu/class/cs97si/suffix-array.pdf</a><br>
<a href="http://en.wikipedia.org/wiki/Suffix_array" target="_blank">http://en.wikipedia.org/wiki/Suffix_array</a></p>
<p>Please write comments if you find anything incorrect, or you want to share more information about the topic discussed above</p>

&#160;
&#160;







&#160;
&#160;
&#160;
<p>Tags: <a href="http://www.geeksforgeeks.org/tag/advance-data-structures/" rel="tag">Advance Data Structures</a>, <a href="http://www.geeksforgeeks.org/tag/advanced-data-structures/" rel="tag">Advanced Data Structures</a>, <a href="http://www.geeksforgeeks.org/tag/pattern-searching/" rel="tag">Pattern Searching</a></p>






				<h3>Source:</h3><p><a href="http://www.geeksforgeeks.org/suffix-array-set-1-introduction/" rel="tag">http://www.geeksforgeeks.org/suffix-array-set-1-introduction/</a></p></div>
			</div></body>
